/*
 * Copyright (c) 2020 Pete Johanson
 *
 * SPDX-License-Identifier: MIT
 */

#include <dt-bindings/zmk/matrix_transform.h>

/ {
	chosen {
		zmk,kscan = &kscan0;
		zmk,matrix_transform = &default_transform;
	};

	default_transform: keymap_transform_0 {
		compatible = "zmk,matrix-transform";
		columns = <16>;
		rows = <4>;
//r6c1, r6c2, r6c3, r6c4, r6c5, r6c6, r6c8, r6c9, r6c10, r6c11, r6c12, r6c13, r6c14, r6c15, r6c16
//r5c1, r5c2, r5c3, r5c4, r5c5, r5c6, r5c8, r5c10, r5c11, r5c12, r5c13, r5c14, r5c15, r5c16, 
//r4c1, r4c3, r4c4, r4c5, r4c6, r4c7, r4c9, r4c10, r4c11, r4c12, r4c13, r4c14, r4c15, r4c16, 
//r3c1, r3c3, r3c4, r3c5, r3c6, r3c7, r3c9, r3c10, r3c11, r3c12, r3c13, r3c14, r3c15, 
//r2c2, r2c3, r2c4, r2c5, r2c6, r2c7, r2c9, r2c10, r2c11, r2c12, r2c13, r2c14, r2c15, r2c16, 
//r1c1, r1c2, r1c4, r1c6, r1c7, r1c9, r1c10, r1c11, r1c12, r1c14, r1c15, r1c16, 
		map = <
RC(0,0) RC(0,1) RC(0,2) RC(0,3) RC(0,4) RC(0,5)                                   RC(0,10) RC(0,11) RC(0,12) RC(0,13) RC(0,14) RC(0,15)
RC(1,0) RC(1,1) RC(1,2) RC(1,3) RC(1,4) RC(1,5)                                   RC(1,10) RC(1,11) RC(1,12) RC(1,13) RC(1,14) RC(1,15)
RC(2,0) RC(2,1) RC(2,2) RC(2,3) RC(2,4) RC(2,5)                                   RC(2,10) RC(2,11) RC(2,12) RC(2,13) RC(2,14) RC(2,15)
                                RC(3,4) RC(3,5) RC(3,6) RC(3,7)   RC(3,8) RC(3,9) RC(3,10) RC(3,11)
		>;
	};

	kscan0: kscan {
		compatible = "zmk,kscan-gpio-matrix";
		label = "KSCAN";

		diode-direction = "row2col";
		row-gpios
			= <&pro_micro 20 GPIO_ACTIVE_HIGH>
			, <&pro_micro 19 GPIO_ACTIVE_HIGH>
			, <&pro_micro 18 GPIO_ACTIVE_HIGH>
			, <&pro_micro 15 GPIO_ACTIVE_HIGH>
			;
		
	};

	// TODO: per-key RGB node(s)?
};
